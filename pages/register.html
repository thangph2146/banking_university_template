<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Đăng ký - Đại học Ngân hàng TP.HCM</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />
    <link href="../public/css/custom.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script src="../public/js/tailwind.config.js"></script>
  </head>
  <body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-primary shadow-sm">
      <div
        class="container mx-auto px-4 flex items-center justify-between"
      >
        <a href="index.html" class="text-2xl font-['Pacifico'] text-white">
            <img src="../images/logo/logo-white.png" alt="logo" class="w-16 h-16">
        </a>
        <nav class="hidden md:flex items-center space-x-8">
          <a
            href="index.html"
            class="text-red-100 hover:text-white transition-colors"
            >Trang chủ</a
          >
          <a href="events.html" class="text-red-100 hover:text-white transition-colors"
            >Sự kiện</a
          >
          <a href="blog.html" class="text-red-100 hover:text-white transition-colors"
            >Blog</a
          >
          <a href="news.html" class="text-red-100 hover:text-white transition-colors"
            >Giới thiệu</a
          >
          <a href="contact.html" class="text-red-100 hover:text-white transition-colors"
            >Liên hệ</a
          >
        </nav>
        <div class="flex items-center space-x-4">
          <a href="login.html" class="text-white font-medium hover:underline"
            >Đăng nhập</a
          >
          <a
            href="register.html"
            class="bg-white text-primary px-4 py-2 !rounded-button whitespace-nowrap hover:bg-red-50 transition-colors shadow-sm"
            >Đăng ký</a
          >
        </div>
        <button
          class="md:hidden w-10 h-10 flex items-center justify-center text-white"
        >
          <i class="ri-menu-line ri-lg"></i>
        </button>
      </div>
    </header>

    <!-- Register Form Section -->
    <section class="py-16">
      <div class="container mx-auto px-4">
        <div class="max-w-md mx-auto">
          <!-- Progress Steps -->
          <div class="flex items-center justify-between mb-8">
            <div class="flex items-center">
              <div class="w-8 h-8 bg-primary text-white rounded-full flex items-center justify-center">1</div>
              <div class="ml-2 text-sm font-medium">Thông tin cá nhân</div>
            </div>
            <div class="flex-1 h-1 mx-4 bg-gray-200">
              <div class="h-full bg-primary" style="width: 0%" id="progressBar"></div>
            </div>
            <div class="flex items-center">
              <div class="w-8 h-8 bg-gray-200 text-gray-600 rounded-full flex items-center justify-center">2</div>
              <div class="ml-2 text-sm font-medium text-gray-600">Hoàn tất</div>
            </div>
          </div>

          <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <div class="bg-primary py-6 px-6">
              <h2 class="text-2xl font-bold text-white text-center">Đăng ký tài khoản</h2>
              <p class="text-red-100 text-center mt-2">Tham gia cùng cộng đồng sinh viên BUH</p>
            </div>
            <div class="p-8">
              <form id="registerForm" class="space-y-6">
                <!-- Họ và tên Field -->
                <div class="relative">
                  <label for="fullName" class="block text-gray-700 font-medium mb-2">
                    Họ và tên
                    <span class="text-red-500">*</span>
                  </label>
                  <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                      <i class="ri-user-line text-gray-400"></i>
                    </div>
                    <input
                      type="text"
                      id="fullName"
                      name="fullName"
                      class="form-input w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                      placeholder="Nhập họ và tên đầy đủ của bạn"
                      required
                    />
                  </div>
                </div>
                
                <!-- Email Field -->
                <div class="relative">
                  <label for="email" class="block text-gray-700 font-medium mb-2">
                    Email trường học
                    <span class="text-red-500">*</span>
                  </label>
                  <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                      <i class="ri-mail-line text-gray-400"></i>
                    </div>
                    <input
                      type="email"
                      id="email"
                      name="email"
                      class="form-input w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                      placeholder="Nhập email trường học của bạn"
                      required
                    />
                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none opacity-0 transition-opacity duration-200" id="emailValidIcon">
                      <i class="ri-checkbox-circle-line text-green-500"></i>
                    </div>
                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none opacity-0 transition-opacity duration-200" id="emailInvalidIcon">
                      <i class="ri-error-warning-line text-red-500"></i>
                    </div>
                  </div>
                  <div class="mt-1">
                    <p class="text-xs text-gray-500">
                      <i class="ri-information-line align-middle"></i>
                      Chỉ chấp nhận email có domain @sv.hub.edu.vn hoặc @hub.edu.vn
                    </p>
                    <p id="emailFeedback" class="text-xs text-red-500 mt-1 hidden"></p>
                  </div>
                </div>
                
                <!-- Mã sinh viên Field -->
                <div class="relative">
                  <label for="studentId" class="block text-gray-700 font-medium mb-2">
                    Mã sinh viên / Mã nhân viên
                    <span class="text-red-500">*</span>
                  </label>
                  <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                      <i class="ri-shield-user-line text-gray-400"></i>
                    </div>
                    <input
                      type="text"
                      id="studentId"
                      name="studentId"
                      class="form-input w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                      placeholder="Nhập mã sinh viên hoặc mã nhân viên"
                      required
                    />
                  </div>
                </div>
                
                <!-- Khoa/Phòng ban Field -->
                <div class="relative">
                  <label for="department" class="block text-gray-700 font-medium mb-2">
                    Khoa/Phòng ban
                    <span class="text-red-500">*</span>
                  </label>
                  <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                      <i class="ri-building-line text-gray-400"></i>
                    </div>
                    <select
                      id="department"
                      name="department"
                      class="form-input w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent appearance-none"
                      required
                    >
                      <option value="" disabled selected>Chọn khoa/phòng ban của bạn</option>
                      <option value="tai-chinh-ngan-hang">Khoa Tài chính - Ngân hàng</option>
                      <option value="ke-toan-kiem-toan">Khoa Kế toán - Kiểm toán</option>
                      <option value="quan-tri-kinh-doanh">Khoa Quản trị Kinh doanh</option>
                      <option value="he-thong-thong-tin-quan-ly">Khoa Hệ thống Thông tin Quản lý</option>
                      <option value="kinh-te-luat">Khoa Kinh tế - Luật</option>
                      <option value="tieng-anh-thuong-mai">Khoa Tiếng Anh Thương mại</option>
                      <option value="ung-dung-toan-tin">Viện Ứng dụng Toán - Tin</option>
                      <option value="phong-ban-khac">Phòng ban khác</option>
                    </select>
                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                      <i class="ri-arrow-down-s-line text-gray-400"></i>
                    </div>
                  </div>
                </div>
                
                <!-- Password Field -->
                <div class="relative">
                  <label for="password" class="block text-gray-700 font-medium mb-2">
                    Mật khẩu
                    <span class="text-red-500">*</span>
                  </label>
                  <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                      <i class="ri-lock-line text-gray-400"></i>
                    </div>
                    <input
                      type="password"
                      id="password"
                      name="password"
                      class="form-input w-full pl-10 pr-20 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                      placeholder="Nhập mật khẩu (ít nhất 8 ký tự)"
                      required
                      minlength="8"
                    />
                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center space-x-2">
                      <div class="pointer-events-none opacity-0 transition-opacity duration-200" id="passwordValidIcon">
                        <i class="ri-checkbox-circle-line text-green-500"></i>
                      </div>
                      <div class="pointer-events-none opacity-0 transition-opacity duration-200" id="passwordInvalidIcon">
                        <i class="ri-error-warning-line text-red-500"></i>
                      </div>
                      <button type="button" id="showPassword" class="text-gray-400 hover:text-gray-500">
                        <i class="ri-eye-off-line"></i>
                      </button>
                    </div>
                  </div>
                  <p id="passwordFeedback" class="text-xs text-red-500 mt-1 hidden"></p>
                </div>
                
                <!-- Confirm Password Field -->
                <div class="relative">
                  <label for="confirmPassword" class="block text-gray-700 font-medium mb-2">
                    Xác nhận mật khẩu
                    <span class="text-red-500">*</span>
                  </label>
                  <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                      <i class="ri-lock-line text-gray-400"></i>
                    </div>
                    <input
                      type="password"
                      id="confirmPassword"
                      name="confirmPassword"
                      class="form-input w-full pl-10 pr-20 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                      placeholder="Nhập lại mật khẩu của bạn"
                      required
                    />
                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center space-x-2">
                      <div class="pointer-events-none opacity-0 transition-opacity duration-200" id="confirmPasswordValidIcon">
                        <i class="ri-checkbox-circle-line text-green-500"></i>
                      </div>
                      <div class="pointer-events-none opacity-0 transition-opacity duration-200" id="confirmPasswordInvalidIcon">
                        <i class="ri-error-warning-line text-red-500"></i>
                      </div>
                      <button type="button" id="showConfirmPassword" class="text-gray-400 hover:text-gray-500">
                        <i class="ri-eye-off-line"></i>
                      </button>
                    </div>
                  </div>
                  <p id="confirmPasswordFeedback" class="text-xs text-red-500 mt-1 hidden"></p>
                </div>
                
                <!-- Terms and Conditions Checkbox -->
                <div class="flex items-center space-x-2">
                  <input 
                    type="checkbox" 
                    id="terms" 
                    name="terms" 
                    class="h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"
                    required
                  />
                  <label for="terms" class="text-sm text-gray-700">
                    Tôi đồng ý với 
                    <a href="#" class="text-primary hover:underline">Điều khoản sử dụng</a> 
                    và
                    <a href="#" class="text-primary hover:underline">Chính sách bảo mật</a>
                  </label>
                </div>
                
                <!-- Submit Button -->
                <button
                  type="submit"
                  class="button-hover w-full bg-primary text-white py-3 px-4 !rounded-button hover:bg-primary/90 transition-colors font-medium flex items-center justify-center"
                >
                  <i class="ri-user-add-line mr-2"></i>
                  Đăng ký
                </button>
              </form>
              
              <div class="mt-6 text-center">
                <p class="text-gray-600">
                  Đã có tài khoản? 
                  <a href="login.html" class="text-primary font-medium hover:underline">Đăng nhập ngay</a>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="bg-primary text-red-100 py-10 md:py-12 relative overflow-hidden">
      <div class="absolute inset-0 bg-gradient-to-b from-primary to-primary/90"></div>
      <div class="container mx-auto px-4 relative z-10">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <a href="index.html" class="text-2xl font-pacifico text-white mb-4 block flex items-center"
              ><img src="../images/logo/logo-white.png" alt="Đại học Ngân hàng TP.HCM logo" class="w-32 h-32"></a
            >
            <p class="mb-4">
              Hệ thống Quản lý Sự kiện Đại học Ngân hàng TP.HCM - Nơi kết nối
              sinh viên với các hoạt động học thuật và ngoại khóa.
            </p>
            <div class="flex space-x-4">
              <a
                href="#"
                class="w-10 h-10 flex items-center justify-center bg-red-900/50 rounded-full hover:bg-white hover:text-primary transition-colors"
                aria-label="Facebook"
              >
                <i class="ri-facebook-fill"></i>
              </a>
              <a
                href="#"
                class="w-10 h-10 flex items-center justify-center bg-red-900/50 rounded-full hover:bg-white hover:text-primary transition-colors"
                aria-label="YouTube"
              >
                <i class="ri-youtube-fill"></i>
              </a>
              <a
                href="#"
                class="w-10 h-10 flex items-center justify-center bg-red-900/50 rounded-full hover:bg-white hover:text-primary transition-colors"
                aria-label="Instagram"
              >
                <i class="ri-instagram-fill"></i>
              </a>
            </div>
          </div>
          <div>
            <h3 class="text-white text-lg font-bold mb-4">Liên kết nhanh</h3>
            <ul class="space-y-2">
              <li>
                <a href="index.html" class="hover:text-white transition-colors inline-flex items-center">
                  <i class="ri-arrow-right-s-line mr-2"></i>Trang chủ</a
                >
              </li>
              <li>
                <a href="events.html" class="hover:text-white transition-colors inline-flex items-center">
                  <i class="ri-arrow-right-s-line mr-2"></i>Sự kiện</a
                >
              </li>
              <li>
                <a href="login.html" class="hover:text-white transition-colors inline-flex items-center">
                  <i class="ri-arrow-right-s-line mr-2"></i>Đăng nhập</a
                >
              </li>
              <li>
                <a href="register.html" class="hover:text-white transition-colors inline-flex items-center">
                  <i class="ri-arrow-right-s-line mr-2"></i>Đăng ký</a
                >
              </li>
              <li>
                <a href="news.html" class="hover:text-white transition-colors inline-flex items-center">
                  <i class="ri-arrow-right-s-line mr-2"></i>Giới thiệu</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h3 class="text-white text-lg font-bold mb-4">Hỗ trợ</h3>
            <ul class="space-y-2">
              <li>
                <a href="user-guide.html" class="hover:text-white transition-colors inline-flex items-center">
                  <i class="ri-arrow-right-s-line mr-2"></i>Hướng dẫn sử dụng</a
                >
              </li>
              <li>
                <a href="faq.html" class="hover:text-white transition-colors inline-flex items-center">
                  <i class="ri-arrow-right-s-line mr-2"></i>Câu hỏi thường gặp</a
                >
              </li>
              <li>
                <a href="privacy.html" class="hover:text-white transition-colors inline-flex items-center">
                  <i class="ri-arrow-right-s-line mr-2"></i>Chính sách bảo mật</a
                >
              </li>
              <li>
                <a href="terms.html" class="hover:text-white transition-colors inline-flex items-center">
                  <i class="ri-arrow-right-s-line mr-2"></i>Điều khoản sử dụng</a
                >
              </li>
              <li>
                <a href="contact.html" class="hover:text-white transition-colors inline-flex items-center">
                  <i class="ri-arrow-right-s-line mr-2"></i>Liên hệ hỗ trợ</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h3 class="text-white text-lg font-bold mb-4">Liên hệ</h3>
            <ul class="space-y-3">
              <li class="flex items-start">
                <div class="w-5 h-5 flex items-center justify-center mr-2 mt-1 text-red-200">
                  <i class="ri-map-pin-line"></i>
                </div>
                <span
                  >36 Tôn Thất Đạm, Phường Nguyễn Thái Bình, Quận 1,
                  TP.HCM</span
                >
              </li>
              <li class="flex items-center">
                <div class="w-5 h-5 flex items-center justify-center mr-2 text-red-200">
                  <i class="ri-phone-line"></i>
                </div>
                <span>(028) 3829 1901</span>
              </li>
              <li class="flex items-center">
                <div class="w-5 h-5 flex items-center justify-center mr-2 text-red-200">
                  <i class="ri-mail-line"></i>
                </div>
                <span>info@hub.edu.vn</span>
              </li>
            </ul>
            <div class="mt-4 p-4 bg-red-900/30 rounded-lg">
              <h4 class="text-white font-medium mb-2">Đăng ký nhận tin</h4>
              <form class="flex">
                <input type="email" placeholder="Email của bạn" class="px-3 py-2 rounded-l-button text-sm w-full focus:outline-none text-gray-700" />
                <button type="submit" class="bg-primary border border-white text-white px-3 py-2 rounded-r-button hover:bg-red-800 transition-colors">
                  <i class="ri-send-plane-fill"></i>
                </button>
              </form>
            </div>
          </div>
        </div>
        <div class="border-t border-red-900/30 mt-8 pt-6 text-center">
          <p>
            &copy; 2025 Đại học Ngân hàng TP.HCM. Tất cả quyền được bảo lưu.
          </p>
        </div>
      </div>
    </footer>

    <!-- Modals -->
    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
      <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4 relative">
        <div class="flex items-center justify-center mb-6">
          <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center">
            <i class="ri-check-line text-4xl text-green-500"></i>
          </div>
        </div>
        <h3 class="text-2xl font-bold text-center text-gray-800 mb-4">Đăng ký thành công!</h3>
        <p class="text-gray-600 text-center mb-6">
          Chúng tôi đã gửi email xác nhận đến địa chỉ email của bạn. Vui lòng kiểm tra và xác nhận tài khoản.
        </p>
        <div class="flex justify-center">
          <button onclick="closeModal('successModal')" class="bg-primary text-white px-6 py-2 rounded-button hover:bg-primary/90 transition-colors">
            Đóng
          </button>
        </div>
      </div>
    </div>

    <!-- Error Modal -->
    <div id="errorModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
      <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4 relative">
        <div class="flex items-center justify-center mb-6">
          <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center">
            <i class="ri-error-warning-line text-4xl text-red-500"></i>
          </div>
        </div>
        <h3 class="text-2xl font-bold text-center text-gray-800 mb-4">Đăng ký thất bại</h3>
        <p id="errorMessage" class="text-gray-600 text-center mb-6">
          Có lỗi xảy ra trong quá trình đăng ký. Vui lòng thử lại sau.
        </p>
        <div class="flex justify-center">
          <button onclick="closeModal('errorModal')" class="bg-primary text-white px-6 py-2 rounded-button hover:bg-primary/90 transition-colors">
            Đóng
          </button>
        </div>
      </div>
    </div>

    <!-- Loading Modal -->
    <div id="loadingModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
      <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4 relative">
        <div class="flex items-center justify-center mb-6">
          <div class="w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin"></div>
        </div>
        <p class="text-gray-600 text-center">Đang xử lý yêu cầu...</p>
      </div>
    </div>

    <script>
      // Mobile menu toggle
      document.addEventListener("DOMContentLoaded", function () {
        const menuButton = document.querySelector("button.md\\:hidden");
        const mobileMenu = document.createElement("div");
        mobileMenu.className =
          "fixed inset-0 bg-primary z-50 transform translate-x-full transition-transform duration-300 ease-in-out";
        mobileMenu.innerHTML = `
        <div class="p-4 flex justify-between items-center border-b border-red-900/30">
          <a href="index.html" class="text-2xl font-['Pacifico'] text-white">
            <img src="../images/logo/logo-white-vertical.png" alt="logo" class="w-16 h-16">
          </a>
          <button class="w-10 h-10 flex items-center justify-center text-white">
            <i class="ri-close-line ri-lg"></i>
          </button>
        </div>
        <nav class="p-4">
          <ul class="space-y-4">
            <li><a href="index.html" class="text-red-100 block py-2">Trang chủ</a></li>
            <li><a href="events.html" class="text-red-100 block py-2">Sự kiện</a></li>
            <li><a href="news.html" class="text-red-100 block py-2">Giới thiệu</a></li>
            <li><a href="contact.html" class="text-red-100 block py-2">Liên hệ</a></li>
            <li">
              <a href="login.html" class="bg-white text-primary px-4 py-2 !rounded-button whitespace-nowrap block text-center mt-2">Đăng nhập</a>
            </li>
            <li>
              <a href="register.html" class="bg-white text-primary px-4 py-2 !rounded-button whitespace-nowrap block text-center mt-2">Đăng ký</a>
            </li>
          </ul>
        </nav>
        `;
        document.body.appendChild(mobileMenu);
        menuButton.addEventListener("click", function () {
          mobileMenu.classList.remove("translate-x-full");
        });
        mobileMenu.querySelector("button").addEventListener("click", function () {
          mobileMenu.classList.add("translate-x-full");
        });
      });

      // Password visibility toggle (cho cả hai trường mật khẩu)
      document.addEventListener("DOMContentLoaded", function () {
        const togglePasswordVisibility = function(passwordId, buttonId) {
          const passwordInput = document.getElementById(passwordId);
          const toggleButton = document.getElementById(buttonId);
          
          if (toggleButton && passwordInput) {
            toggleButton.addEventListener("click", function () {
              // Toggle password visibility
              const type = passwordInput.getAttribute("type") === "password" ? "text" : "password";
              passwordInput.setAttribute("type", type);
              
              // Toggle icon
              const icon = toggleButton.querySelector("i");
              if (type === "text") {
                icon.classList.remove("ri-eye-off-line");
                icon.classList.add("ri-eye-line");
              } else {
                icon.classList.remove("ri-eye-line");
                icon.classList.add("ri-eye-off-line");
              }
            });
          }
        };
        
        // Áp dụng cho cả hai trường mật khẩu
        togglePasswordVisibility("password", "showPassword");
        togglePasswordVisibility("confirmPassword", "showConfirmPassword");
      });

      // Form validation
      document.addEventListener("DOMContentLoaded", function () {
        const registerForm = document.getElementById("registerForm");
        
        // Modal functions
        window.showModal = function(modalId) {
          const modal = document.getElementById(modalId);
          modal.classList.remove('hidden');
          modal.classList.add('flex');
          modal.querySelector('.bg-white').classList.add('modal-enter');
        }

        window.closeModal = function(modalId) {
          const modal = document.getElementById(modalId);
          modal.classList.add('hidden');
          modal.classList.remove('flex');
          modal.querySelector('.bg-white').classList.remove('modal-enter');
        }

        window.showError = function(message) {
          document.getElementById('errorMessage').textContent = message;
          showModal('errorModal');
        }

        // Progress bar handling
        const updateProgress = () => {
          const form = document.getElementById('registerForm');
          const inputs = form.querySelectorAll('input[required], select[required]');
          let filledInputs = 0;
          
          inputs.forEach(input => {
            if (input.type === 'checkbox') {
              if (input.checked) filledInputs++;
            } else if (input.value.trim() !== '') {
              filledInputs++;
            }
          });
          
          const progress = (filledInputs / inputs.length) * 100;
          document.getElementById('progressBar').style.width = `${progress}%`;
          
          // Update step indicators
          if (progress === 100) {
            document.querySelector('.flex.items-center:last-child div:first-child').classList.remove('bg-gray-200', 'text-gray-600');
            document.querySelector('.flex.items-center:last-child div:first-child').classList.add('bg-primary', 'text-white');
            document.querySelector('.flex.items-center:last-child div:last-child').classList.remove('text-gray-600');
          } else {
            document.querySelector('.flex.items-center:last-child div:first-child').classList.add('bg-gray-200', 'text-gray-600');
            document.querySelector('.flex.items-center:last-child div:first-child').classList.remove('bg-primary', 'text-white');
            document.querySelector('.flex.items-center:last-child div:last-child').classList.add('text-gray-600');
          }
        };

        // Password strength indicators
        const updatePasswordStrength = (password) => {
          const indicators = {
            length: password.length >= 8,
            case: /(?=.*[a-z])(?=.*[A-Z])/.test(password),
            number: /\d/.test(password),
            special: /[!@#$%^&*(),.?":{}|<>]/.test(password)
          };
          
          Object.entries(indicators).forEach(([key, valid], index) => {
            const indicator = document.querySelectorAll('.text-gray-500')[index];
            if (valid) {
              indicator.classList.remove('text-gray-500');
              indicator.classList.add('text-green-500');
              indicator.querySelector('i').classList.remove('ri-checkbox-circle-line');
              indicator.querySelector('i').classList.add('ri-checkbox-circle-fill');
            } else {
              indicator.classList.add('text-gray-500');
              indicator.classList.remove('text-green-500');
              indicator.querySelector('i').classList.add('ri-checkbox-circle-line');
              indicator.querySelector('i').classList.remove('ri-checkbox-circle-fill');
            }
          });
        };

        // Form validation helper functions
        const validateEmail = (email) => {
          const emailRegex = /@(sv\.)?buh\.edu\.vn$/i;
          return emailRegex.test(email);
        }

        const validatePassword = (password) => {
          const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/;
          return passwordRegex.test(password);
        }

        const validateStudentId = (studentId) => {
          return studentId.length > 0;
        }

        if (registerForm) {
          // Helper function to show/hide validation icons
          const toggleValidationIcons = (inputId, isValid) => {
            const validIcon = document.getElementById(`${inputId}ValidIcon`);
            const invalidIcon = document.getElementById(`${inputId}InvalidIcon`);
            const input = document.getElementById(inputId);
            const feedbackElement = document.getElementById(`${inputId}Feedback`);
            
            if (input.value.trim() === '') {
              validIcon.style.opacity = '0';
              invalidIcon.style.opacity = '0';
              input.classList.remove('border-red-500', 'border-green-500');
              feedbackElement.classList.add('hidden');
              return;
            }
            
            if (isValid) {
              validIcon.style.opacity = '1';
              invalidIcon.style.opacity = '0';
              input.classList.remove('border-red-500');
              input.classList.add('border-green-500');
              feedbackElement.classList.add('hidden');
            } else {
              validIcon.style.opacity = '0';
              invalidIcon.style.opacity = '1';
              input.classList.remove('border-green-500');
              input.classList.add('border-red-500');
              feedbackElement.classList.remove('hidden');
            }
          };

          // Add input event listeners for progress bar
          registerForm.querySelectorAll('input, select').forEach(input => {
            input.addEventListener('input', updateProgress);
          });

          // Real-time validation
          const inputs = registerForm.querySelectorAll('input[required]');
          inputs.forEach(input => {
            input.addEventListener('input', function() {
              switch(input.id) {
                case 'email':
                  const isValidEmail = validateEmail(input.value);
                  toggleValidationIcons('email', isValidEmail);
                  if (!isValidEmail && input.value.trim() !== '') {
                    document.getElementById('emailFeedback').textContent = 'Email phải có đuôi @sv.hub.edu.vn hoặc @hub.edu.vn';
                  }
                  break;
                case 'password':
                  const isValidPassword = validatePassword(input.value);
                  toggleValidationIcons('password', isValidPassword);
                  if (!isValidPassword && input.value.trim() !== '') {
                    document.getElementById('passwordFeedback').textContent = 'Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa, chữ thường và số';
                  }
                  // Also check confirm password if it has value
                  const confirmPassword = document.getElementById('confirmPassword');
                  if (confirmPassword.value.trim() !== '') {
                    const isMatch = confirmPassword.value === input.value;
                    toggleValidationIcons('confirmPassword', isMatch);
                    if (!isMatch) {
                      document.getElementById('confirmPasswordFeedback').textContent = 'Mật khẩu xác nhận không khớp';
                    }
                  }
                  break;
                case 'confirmPassword':
                  const password = document.getElementById('password').value;
                  const isMatch = input.value === password;
                  toggleValidationIcons('confirmPassword', isMatch);
                  if (!isMatch && input.value.trim() !== '') {
                    document.getElementById('confirmPasswordFeedback').textContent = 'Mật khẩu xác nhận không khớp';
                  }
                  break;
                default:
                  if (input.value.trim() !== '') {
                    input.classList.remove('border-red-500');
                    input.classList.add('border-green-500');
                  } else {
                    input.classList.remove('border-red-500', 'border-green-500');
                  }
              }
            });

            // Also trigger validation on blur
            input.addEventListener('blur', function() {
              if (input.value.trim() === '') {
                input.classList.add('border-red-500');
                const feedbackElement = document.getElementById(`${input.id}Feedback`);
                if (feedbackElement) {
                  feedbackElement.textContent = 'Trường này là bắt buộc';
                  feedbackElement.classList.remove('hidden');
                }
              }
            });
          });

          // Form submission handling
          registerForm.addEventListener("submit", async function (event) {
            event.preventDefault();
            
            // Show loading
            showModal('loadingModal');
            
            // Get form values
            const formData = {
              fullName: document.getElementById("fullName").value,
              email: document.getElementById("email").value,
              studentId: document.getElementById("studentId").value,
              department: document.getElementById("department").value,
              password: document.getElementById("password").value,
              confirmPassword: document.getElementById("confirmPassword").value,
              terms: document.getElementById("terms").checked
            };
            
            // Reset all validation states
            inputs.forEach(input => {
              input.classList.remove('border-red-500', 'border-green-500');
              const feedbackElement = document.getElementById(`${input.id}Feedback`);
              if (feedbackElement) {
                feedbackElement.classList.add('hidden');
              }
            });
            
            // Validate all fields
            let hasError = false;
            
            if (!formData.fullName || !formData.email || !formData.studentId || !formData.department || !formData.password) {
              hasError = true;
              inputs.forEach(input => {
                if (!input.value.trim()) {
                  input.classList.add('border-red-500');
                  const feedbackElement = document.getElementById(`${input.id}Feedback`);
                  if (feedbackElement) {
                    feedbackElement.textContent = 'Trường này là bắt buộc';
                    feedbackElement.classList.remove('hidden');
                  }
                }
              });
            }
            
            if (!validateEmail(formData.email)) {
              hasError = true;
              toggleValidationIcons('email', false);
            }
            
            if (!validatePassword(formData.password)) {
              hasError = true;
              toggleValidationIcons('password', false);
            }
            
            if (formData.password !== formData.confirmPassword) {
              hasError = true;
              toggleValidationIcons('confirmPassword', false);
            }
            
            if (!formData.terms) {
              hasError = true;
              document.getElementById("terms").classList.add('border-red-500');
            }
            
            if (hasError) {
              closeModal('loadingModal');
              showError('Vui lòng kiểm tra lại thông tin đăng ký');
              return;
            }

            try {
              // Giả lập API call
              await new Promise(resolve => setTimeout(resolve, 1500));
              
              // Đóng loading và hiển thị thành công
              closeModal('loadingModal');
              showModal('successModal');
              
              // Reset form và validation states
              registerForm.reset();
              inputs.forEach(input => {
                input.classList.remove('border-red-500', 'border-green-500');
                const validIcon = document.getElementById(`${input.id}ValidIcon`);
                const invalidIcon = document.getElementById(`${input.id}InvalidIcon`);
                if (validIcon) validIcon.style.opacity = '0';
                if (invalidIcon) invalidIcon.style.opacity = '0';
              });
              
              // Reset progress bar
              updateProgress();
              
              // Redirect sau 3 giây
              setTimeout(() => {
                window.location.href = 'login.html';
              }, 3000);
              
            } catch (error) {
              closeModal('loadingModal');
              showError('Có lỗi xảy ra trong quá trình đăng ký. Vui lòng thử lại sau.');
            }
          });
        }
      });
    </script>
  </body>
</html> 